var Ft=Object.defineProperty,Lt=Object.defineProperties;var kt=Object.getOwnPropertyDescriptors;var Fe=Object.getOwnPropertySymbols;var mt=Object.prototype.hasOwnProperty,vt=Object.prototype.propertyIsEnumerable;var it=(s,e,t)=>e in s?Ft(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,W=(s,e)=>{for(var t in e||(e={}))mt.call(e,t)&&it(s,t,e[t]);if(Fe)for(var t of Fe(e))vt.call(e,t)&&it(s,t,e[t]);return s},gt=(s,e)=>Lt(s,kt(e));var Le=(s,e)=>{var t={};for(var i in s)mt.call(s,i)&&e.indexOf(i)<0&&(t[i]=s[i]);if(s!=null&&Fe)for(var i of Fe(s))e.indexOf(i)<0&&vt.call(s,i)&&(t[i]=s[i]);return t};var l=(s,e,t)=>(it(s,typeof e!="symbol"?e+"":e,t),t),st=(s,e,t)=>{if(!e.has(s))throw TypeError("Cannot "+t)};var r=(s,e,t)=>(st(s,e,"read from private field"),t?t.call(s):e.get(s)),h=(s,e,t)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,t)},p=(s,e,t,i)=>(st(s,e,"write to private field"),i?i.call(s,t):e.set(s,t),t),nt=(s,e,t,i)=>({set _(n){p(s,e,n,t)},get _(){return r(s,e,i)}}),x=(s,e,t)=>(st(s,e,"access private method"),t);import{B as k,S as yt,R as ye,c as B,j as rt,a as Pt,m as Wt,u as Yt,r as T,o as Ht,i as Xt,b as xe,g as Zt,d as Vt}from"./vendor.b6c7d401.js";const Kt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}};Kt();var I;(function(s){s[s.NORMAL=0]="NORMAL",s[s.BORDER_LESS=1]="BORDER_LESS",s[s.FULLSCREEN=2]="FULLSCREEN",s[s.WIDGET=3]="WIDGET"})(I||(I={}));var ke;(function(s){s[s.TOP=200]="TOP",s[s.MIDDLE=100]="MIDDLE",s[s.BOTTOM=0]="BOTTOM"})(ke||(ke={}));var v;(function(s){s[s.NORMAL=1]="NORMAL",s[s.MINIMIZED=2]="MINIMIZED",s[s.MAXIMIZED=4]="MAXIMIZED"})(v||(v={}));var O;(function(s){s[s.NONE=0]="NONE",s[s.MINIMIZE=1]="MINIMIZE",s[s.MAXIMIZE=2]="MAXIMIZE",s[s.CLOSE=4]="CLOSE"})(O||(O={}));var y;(function(s){s[s.NONE=0]="NONE",s[s.TOP=1]="TOP",s[s.RIGHT=2]="RIGHT",s[s.BOTTOM=4]="BOTTOM",s[s.LEFT=8]="LEFT"})(y||(y={}));var A;(function(s){s[s.CENTER=0]="CENTER",s[s.TOP=1]="TOP",s[s.RIGHT=2]="RIGHT",s[s.BOTTOM=4]="BOTTOM",s[s.LEFT=8]="LEFT"})(A||(A={}));var $;const _=class{static getInstance(){return r(_,$).get(this)}constructor(){if(r(_,$).has(this.constructor))return r(_,$).get(this.constructor);r(_,$).set(this.constructor,this)}};let K=_;$=new WeakMap,h(K,$,new Map);class d{constructor(e,t){this.x=e,this.y=t}static add(e,t){return new d(e.x+t.x,e.y+t.y)}static subtract(e,t){return new d(e.x-t.x,e.y-t.y)}static multiply(e,t){return new d(e.x*t.x,e.y*t.y)}static divide(e,t){return new d(e.x/t.x,e.y/t.y)}static equals(e,t){return e.x==t.x&&e.y==t.y}static distance(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}static angle(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}static angleBetween(e,t,i){return Math.acos(d.dot(d.subtract(t,e),d.subtract(i,e))/(d.distance(e,t)*d.distance(e,i)))}static dot(e,t){return e.x*t.x+e.y*t.y}static cross(e,t){return e.x*t.y-e.y*t.x}static crossRatio(e,t){return(e.x*t.y-e.y*t.x)/(d.distance(e,t)*d.distance(e,t))}static rotate(e,t){return new d(e.x*Math.cos(t)-e.y*Math.sin(t),e.x*Math.sin(t)+e.y*Math.cos(t))}static rotateAround(e,t,i){return d.add(d.subtract(e,t),d.rotate(d.subtract(t,e),i))}static scale(e,t){return new d(e.x*t.x,e.y*t.y)}static scaleAround(e,t,i){return d.add(d.subtract(e,t),d.scale(d.subtract(t,e),i))}static reflect(e,t){return new d(e.x-2*d.dot(e,t)/d.dot(t,t)*t.x,e.y-2*d.dot(e,t)/d.dot(t,t)*t.y)}static reflectAround(e,t,i){return d.add(d.subtract(e,t),d.reflect(d.subtract(t,e),i))}}function ot(s,e,t){return(s.x-t.x)*(e.y-t.y)-(e.x-t.x)*(s.y-t.y)}function xt(s,e,t,i){let n=ot(s,e,t),a=ot(s,t,i),c=ot(s,i,e),u=n<0||a<0||c<0,m=n>0||a>0||c>0;return!(u&&m)}class $t{constructor(e){l(this,"positionStrategy");l(this,"panelClass","overlay-panel");l(this,"hasBackdrop",!1);l(this,"backdropClass","overlay-transparent-backdrop");l(this,"width");l(this,"height");l(this,"minWidth");l(this,"minHeight");l(this,"maxWidth");l(this,"maxHeight");l(this,"disposeOnNavigation",!1);if(e){const t=Object.keys(e);for(const i of t)e[i]!==void 0&&(this[i]=e[i])}}}var X;class Ut{constructor(e){h(this,X,void 0);p(this,X,new k(e))}get observable(){return r(this,X).asObservable()}get current(){return r(this,X).value}set current(e){e!==r(this,X).value&&r(this,X).next(e)}}X=new WeakMap;class Y{constructor(e,t,i=0,n=0,a){l(this,"originX");l(this,"originY");l(this,"overlayX");l(this,"overlayY");this.offsetX=i,this.offsetY=n,this.panelClass=a,this.originX=e.originX,this.originY=e.originY,this.overlayX=t.overlayX,this.overlayY=t.overlayY}}const Gt=[new Y({originX:"start",originY:"bottom"},{overlayX:"start",overlayY:"top"}),new Y({originX:"end",originY:"bottom"},{overlayX:"end",overlayY:"top"}),new Y({originX:"start",originY:"top"},{overlayX:"start",overlayY:"bottom"}),new Y({originX:"end",originY:"top"},{overlayX:"end",overlayY:"bottom"})];var ee,te,ie,at,Ze,dt,Zi,Ne,se,ne,Ve,jt,Ke,Qt,$e,Jt,Ue,qt,Ie,Et,Ge,_t,je,ei,re,ct,Qe,ti;class bt{constructor(e){h(this,ie);h(this,dt);h(this,Ve);h(this,Ke);h(this,$e);h(this,Ue);h(this,Ie);h(this,Ge);h(this,je);h(this,re);h(this,Qe);h(this,ee,void 0);h(this,te,void 0);h(this,Ze,document);h(this,Ne,Gt);h(this,se,!1);h(this,ne,!1);this.setOrigin(e)}setOrigin(e){return p(this,ee,e),this}attach(e){p(this,te,e)}detach(){p(this,te,void 0)}apply(){if(!r(this,ee)||!r(this,ie,at))throw new Error("Origin and overlay must be set before calling apply.");const e=x(this,Ve,jt).call(this),t=r(this,ie,at).getBoundingClientRect();let i;for(const n of r(this,Ne)){const a=x(this,Ke,Qt).call(this,e,n),c=x(this,$e,Jt).call(this,a,t,n),u=x(this,Ue,qt).call(this,c,t,n);if(u.isCompletelyWithinViewport){x(this,re,ct).call(this,n,c);return}if(x(this,Ge,_t).call(this,u,c,t)){const m=x(this,je,ei).call(this,u,c,t);x(this,re,ct).call(this,n,m);return}(!i||i.overlayFit.visibleArea<u.visibleArea)&&(i={overlayFit:u,overlayPoint:c,originPoint:a,position:n,overlayRect:t})}x(this,re,ct).call(this,i.position,i.originPoint)}dispose(){}withPositions(e){return p(this,Ne,e),this}withHorizontalFlexible(e=!0){return p(this,ne,e),this}withVerticalFlexible(e=!0){return p(this,se,e),this}}ee=new WeakMap,te=new WeakMap,ie=new WeakSet,at=function(){var e,t;return(t=(e=r(this,te))==null?void 0:e.current)!=null?t:null},Ze=new WeakMap,dt=new WeakSet,Zi=function(){return r(this,Ze)},Ne=new WeakMap,se=new WeakMap,ne=new WeakMap,Ve=new WeakSet,jt=function(){const e=r(this,ee);if(!e)throw new Error("Origin not set.");if(e instanceof Element)return e.getBoundingClientRect();if(ii(e)){if(e.current)return e.current.getBoundingClientRect();throw new Error("RefObject origin is not a valid HTMLElement")}const t=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+t,height:i,width:t}},Ke=new WeakSet,Qt=function(e,t){const{originX:i,originY:n}=t;let a,c;return i==="center"?a=e.left+e.width/2:a=i==="start"?e.left:e.right,n==="center"?c=e.top+e.height/2:c=n==="top"?e.top:e.bottom,{x:a,y:c}},$e=new WeakSet,Jt=function(e,t,i){const{overlayX:n,overlayY:a}=i;let c,u;return n==="center"?c=-t.width/2:c=n==="start"?0:-t.width,a==="center"?u=-t.height/2:u=a==="top"?0:-t.height,c+=e.x+i.offsetX,u+=e.y+i.offsetY,{x:c,y:u}},Ue=new WeakSet,qt=function(e,t,i){let{x:n,y:a}=e,c=0-n,u=n+t.width-window.innerWidth,m=0-a,w=a+t.height-window.innerHeight,E=x(this,Ie,Et).call(this,t.width,c,u),F=x(this,Ie,Et).call(this,t.height,m,w),S=E*F;return{visibleArea:S,isCompletelyWithinViewport:t.width*t.height===S,fitsInViewportVertically:F===t.height,fitsInViewportHorizontally:E==t.width}},Ie=new WeakSet,Et=function(e,...t){return t.reduce((i,n)=>i-Math.max(n,0),e)},Ge=new WeakSet,_t=function(e,t,i){if(r(this,ne)||r(this,se)){let n=e.fitsInViewportHorizontally,a=e.fitsInViewportVertically;return!n&&!a?!1:(!n&&r(this,ne)&&(n=i.height<=window.innerHeight),!a&&r(this,se)&&(a=i.width<=window.innerWidth),a&&n)}return!1},je=new WeakSet,ei=function(e,t,i){let{x:n,y:a}=t;const c=x(this,Qe,ti).call(this);return e.fitsInViewportHorizontally||(n<c.left&&(n=c.left),n+i.width>c.right&&(n=c.right-i.width)),e.fitsInViewportVertically||(a<c.top&&(a=c.top),a+i.height>c.bottom&&(a=c.bottom-i.height)),{x:n,y:a}},re=new WeakSet,ct=function(e,t){const i=r(this,ie,at);if(i){let{x:n,y:a}=t;i.style.position="absolute",i.style.zIndex="1000",i.style.left=`${n}px`,i.style.top=`${a}px`}},Qe=new WeakSet,ti=function(){return{width:window.innerWidth,height:window.innerHeight,top:0,right:window.innerWidth,bottom:window.innerHeight,left:0}};function ii(s){return typeof s=="object"&&s.current instanceof HTMLElement}var Ae,Me;class si{constructor(e){l(this,"overlayRef",new Ut(null));l(this,"node");l(this,"attached",!1);l(this,"_backdropClick",new yt);h(this,Ae,Pe.getInstance());h(this,Me,void 0);this.config=e}get backdropClick$(){return this._backdropClick.asObservable()}attach(e){var t;if(this.attached)throw new Error("Overlay is already attached.");return this.node=ye.createElement("div",{ref:this.overlayRef,className:B(this.config.panelClass)},e),r(this,Ae).append(this),(t=this.config.positionStrategy)==null||t.attach(this.overlayRef),p(this,Me,this.overlayRef.observable.subscribe(i=>{var n;i&&((n=this.config.positionStrategy)==null||n.apply())})),this.attached=!0,this}detach(){var e,t,i;r(this,Ae).remove(this),(t=(e=this.config.positionStrategy)==null?void 0:e.detach)==null||t.call(e),this.attached=!1,(i=r(this,Me))==null||i.unsubscribe()}updatePosition(e){var t;e&&this.config.positionStrategy instanceof bt&&this.config.positionStrategy.setOrigin(e),(t=this.config.positionStrategy)==null||t.apply()}}Ae=new WeakMap,Me=new WeakMap;class ni{attach(e){throw new Error("Method not implemented.")}detach(){throw new Error("Method not implemented.")}apply(){throw new Error("Method not implemented.")}dispose(){throw new Error("Method not implemented.")}}class ri{global(){return new ni}flexibleConnectedTo(e){return new bt(e)}}var Je;class Pe extends K{constructor(){super();l(this,"overlays$",new k([]));h(this,Je,new ri)}position(){return r(this,Je)}create(e){const t=new $t(e);return new si(t)}append(e){this.overlays$.next([...this.overlays$.getValue(),e])}remove(e){this.overlays$.next(this.overlays$.getValue().filter(t=>t!==e))}}Je=new WeakMap;const o=rt.exports.jsx,b=rt.exports.jsxs,We=rt.exports.Fragment,M=class{constructor(e,t){this.baseLayerGlyph=e,this.overlayLayerGlyph=t}};let g=M;l(g,"New",new M("\uF037","\uF038")),l(g,"Copy",new M("\uF021","\uF022")),l(g,"CopyLocation",new M("\uF02F","\uF030")),l(g,"Paste",new M("\uF023","\uF024")),l(g,"Cut",new M("\uF03D","\uF03E")),l(g,"Rename",new M("\uF027","\uF028")),l(g,"Share",new M("\uF025","\uF026")),l(g,"Delete",new M("\uF035","\uF036")),l(g,"SortBy",new M("\uF029","\uF02A")),l(g,"Properties",new M("\uF031","\uF032")),l(g,"PropertiesFolder",new M("\uF031","\uF032")),l(g,"CreateFolder",new M("\uF033","\uF034"));function R({glyph:s,className:e="",style:t}){return b("div",{className:`colored-icon ${e}`,style:t,children:[o("div",{className:"colored-icon-base-layer",children:s.baseLayerGlyph}),s.overlayLayerGlyph&&o("div",{className:"colored-icon-overlay-layer",children:s.overlayLayerGlyph})]})}function H({name:s,className:e,style:t}){return o("i",{className:B("iconfont",`icon-${s}`,e),style:t})}var Q;(function(s){s[s.Menu=0]="Menu",s[s.Separator=1]="Separator",s[s.QuickActions=2]="QuickActions"})(Q||(Q={}));function Nt({panel:s}){const{options:e}=s;let t=!1,i=!1;for(const n of e)if(n.type!==Q.Separator&&(n.checked&&(t=!0),n.icon&&(i=!0),t&&i))break;return o("ul",{className:"context-menu",children:e.map((n,a)=>{const{type:c,text:u,icon:m,shortcut:w,checked:E,disabled:F,children:S}=n,f=S&&S.length>0;switch(c){case Q.Separator:return o("li",{className:"context-menu-separator",children:u?o("div",{className:"context-menu-separator-text",children:u}):o("div",{className:"context-menu-separator-line"})},`separator-${a}`);case Q.QuickActions:return o("li",{className:"context-menu-item-quick-actions",children:S==null?void 0:S.map(V=>o("div",{className:"context-menu-item-quick-action-icon",children:V.icon&&o(It,{icon:V.icon})}))},`quick-actions-${a}`);default:return b("li",{onPointerEnter:V=>s.onPointerEnter(V,n),className:B("context-menu-item",{"context-menu-item-disabled":F}),onClick:()=>{!n.disabled&&!f&&s.onSelect(n)},children:[t&&o("span",{className:"context-menu-item-checkmark",children:E?"\u221A":""}),i&&o("div",{className:"context-menu-item-icon",children:m&&o(It,{icon:m})}),o("div",{className:"context-menu-item-title",children:u}),w&&o("div",{className:"context-menu-item-shortcut",children:w}),f&&o("div",{className:"context-menu-item-children-mark",children:o(H,{name:"right"})})]},`item-${a}`)}})})}function It({icon:s,image:e}){return e?o("img",{src:e}):typeof s=="string"?o(H,{name:s}):s instanceof g?o(R,{glyph:s,style:{fontSize:"16px"}}):null}var Oe,qe,z,Se,oe,Te,_e,oi,et,ai;const pt=class{constructor(e,t,i){h(this,_e);h(this,et);h(this,Oe,Pe.getInstance());h(this,qe,Mt.getInstance());h(this,z,void 0);h(this,Se,void 0);h(this,oe,{x:0,y:0});h(this,Te,{x:0,y:0});this.options=e,this.overlayController=t,this.parent=i}onPointerEnter(e,t){if(r(this,z)){if(!x(this,_e,oi).call(this,e))return;r(this,z).dispose(),p(this,z,void 0),p(this,Se,void 0)}t.children&&(p(this,Se,t),x(this,et,ai).call(this,e,t))}onSelect(e){var t;(t=e.onSelect)==null||t.call(e,e),r(this,qe).dispose()}dispose(){var e;this.overlayController.detach(),(e=r(this,z))==null||e.dispose()}};let At=pt;Oe=new WeakMap,qe=new WeakMap,z=new WeakMap,Se=new WeakMap,oe=new WeakMap,Te=new WeakMap,_e=new WeakSet,oi=function(e){if(r(this,z)){const t=r(this,z).overlayController.overlayRef.current;if(t){const i=t.getBoundingClientRect(),n=new d(e.clientX,e.clientY),a=new d(n.x<i.left?i.left:i.right,i.top),c=new d(n.x<i.left?i.left:i.right,i.bottom);return!(xt(n,r(this,oe),a,c)||xt(n,r(this,oe),r(this,Te),c))}}return!0},et=new WeakSet,ai=function(e,t){const i=e.target.closest(".context-menu-item");if(!i)return;const n=i.getBoundingClientRect();p(this,oe,{x:e.clientX,y:n.top}),p(this,Te,{x:e.clientX,y:n.bottom});const a=r(this,Oe).position().flexibleConnectedTo(i).withPositions([new Y({originX:"end",originY:"top"},{overlayX:"start",overlayY:"top"},0,-4),new Y({originX:"start",originY:"top"},{overlayX:"end",overlayY:"top"},0,-4)]).withVerticalFlexible(),c=r(this,Oe).create({positionStrategy:a});p(this,z,new pt(t.children,c,this));const u=ye.createElement(Nt,{panel:r(this,z)});c.attach(u)};var U,De,Ot;class Mt extends K{constructor(e){super();h(this,De);h(this,U,void 0);this.overlay=e,document.body.addEventListener("contextmenu",t=>{t.preventDefault()})}show(e,t){if(!Array.isArray(t))throw new Error("options must be array of ContextMenuItem");const i=this.overlay.position().flexibleConnectedTo(e).withPositions([new Y({originX:"start",originY:"top"},{overlayX:"start",overlayY:"top"}),new Y({originX:"start",originY:"top"},{overlayX:"end",overlayY:"top"})]).withVerticalFlexible();x(this,De,Ot).call(this,i,t)}dropdown(e,t){if(!(e instanceof HTMLElement||e.current instanceof HTMLElement))throw new Error("origin must be HTMLElement or React.RefObject<HTMLElement>");if(!Array.isArray(t))throw new Error("options must be array of ContextMenuItem");const i=this.overlay.position().flexibleConnectedTo(e);x(this,De,Ot).call(this,i,t)}dispose(){var e;(e=r(this,U))==null||e.dispose(),p(this,U,void 0)}}U=new WeakMap,De=new WeakSet,Ot=function(e,t){const i=this.overlay.create({positionStrategy:e,hasBackdrop:!0});p(this,U,new At(t,i));const n=ye.createElement(Nt,{panel:r(this,U)});i.attach(n);const a=i.backdropClick$.subscribe(()=>{this.dispose(),a.unsubscribe()})};class Ye{constructor(e,t,i=new d(0,0)){this.horizontal=e,this.vertical=t,this.offset=i}}var ae,ce,Be;class ci{constructor(){h(this,ae,0);h(this,ce,[0,0]);h(this,Be,new yt);l(this,"mouseShake$",r(this,Be).asObservable())}move(e){const t=[e.movementX,e.movementY];t[0]*r(this,ce)[0]+t[1]*r(this,ce)[1]<0&&(nt(this,ae)._++,r(this,ae)===3&&r(this,Be).next(e),setTimeout(()=>{nt(this,ae)._--},700)),p(this,ce,t)}}ae=new WeakMap,ce=new WeakMap,Be=new WeakMap;class li{constructor(e=256){l(this,"cache",new Map);this.capacity=e}get(e){if(!this.cache.has(e))return;let t=this.cache.get(e);return t&&(this.cache.delete(e),this.cache.set(e,t)),t}set(e,t){this.cache.has(e)?this.cache.delete(e):this.cache.size==this.capacity&&this.cache.delete(this.leastUsed),this.cache.set(e,t)}remove(e){this.cache.delete(e)}get leastUsed(){return this.cache.keys().next().value}get mostUsed(){return Array.from(this.cache.keys()).pop()}get size(){return this.cache.size}}var le,he,ue,de;class hi{constructor(e){h(this,le,0);h(this,he,0);h(this,ue,0);h(this,de,0);this.element=e}set left(e){p(this,le,e),this.element.style.left=`${r(this,le)}px`}get left(){return r(this,le)}set top(e){p(this,he,e),this.element.style.top=`${r(this,he)}px`}get top(){return r(this,he)}set width(e){p(this,ue,e),this.element.style.width=`${r(this,ue)}px`}get width(){return r(this,ue)}set height(e){p(this,de,e),this.element.style.height=`${r(this,de)}px`}get height(){return r(this,de)}}le=new WeakMap,he=new WeakMap,ue=new WeakMap,de=new WeakMap;class St extends K{constructor(e,t){super();l(this,"buttons$",new k([]));this.windowService=e,this.appService=t,Pt([e.activeWindow$,e.windows$]).pipe(Wt(([i,n])=>{const a=Yt(n.filter(([m])=>m.options.type!==I.WIDGET).map(([m])=>m.application.constructor)),c=i==null?void 0:i.application.constructor,u=[];for(const m of Di){const w=a.findIndex(E=>E===m);u.push({App:m,active:c===m,running:w!==-1,ref:T.exports.createRef()}),w!==-1&&a.splice(w,1)}for(const m of a)u.push({App:m,active:c===m,running:!0,ref:T.exports.createRef()});return u})).subscribe(i=>{this.buttons=i})}get buttons(){return this.buttons$.value}set buttons(e){this.buttons$.next(e)}getButtonByApp(e){return this.buttons.find(t=>t.App===e)}getButtonRectByApp(e){var i;const t=this.getButtonByApp(e);if(t)return(i=t.ref.current)==null?void 0:i.getBoundingClientRect()}onClickButton(e){const t=this.windowService.windows.map(([i])=>i).find(i=>i.application.constructor===e);t?this.windowService.activeWindow===t?t.options.type===I.WIDGET?t.close():t.minimize():t.restoreWindow():this.appService.launch(e)}}var pe,G,D,N,Re,we,Z,fe,me;const wt=class{constructor(e,t){l(this,"windowId",wt.windowId++);l(this,"rect");l(this,"level$");l(this,"active$",new k(!0));l(this,"windowResizeType$");h(this,pe,0);h(this,G,!1);h(this,D,y.NONE);h(this,N,void 0);l(this,"windowService",He.getInstance());l(this,"taskBarService",St.getInstance());h(this,Re,v.NORMAL);h(this,we,void 0);h(this,Z,void 0);h(this,fe,0);h(this,me,0);this.options=e,this.application=t,this.level$=new k(e.level),this.windowResizeType$=new k(e.defaultResizeType)}get level(){return this.level$.value}set level(e){this.level$.next(e)}get active(){return this.active$.value}set active(e){this.active$.next(e)}get windowResizeType(){return this.windowResizeType$.value}set windowResizeType(e){this.windowResizeType$.next(e)}set zIndex(e){r(this,N)&&(r(this,N).style.zIndex=e+this.level+""),p(this,pe,e)}get zIndex(){return r(this,pe)}init(e){if(p(this,N,e),this.zIndex=r(this,pe),this.rect=new hi(e),this.options.type===I.FULLSCREEN)this.rect.left=0,this.rect.top=0;else{let t=this.windowService.windowContainer.clientWidth,i=this.windowService.windowContainer.clientHeight;this.rect.width=this.options.width,this.rect.height=this.options.height;const n=this.options.position;if(n instanceof d)this.rect.left=n.x,this.rect.top=n.y;else if(n instanceof Ye){switch(n.horizontal){case A.LEFT:this.rect.left=n.offset.x;break;case A.RIGHT:this.rect.left=t-this.rect.width+n.offset.x;break;case A.CENTER:this.rect.left=Math.max((t-this.rect.width)/2+n.offset.x,0);break}switch(n.vertical){case A.TOP:this.rect.top=n.offset.y;break;case A.BOTTOM:this.rect.top=i-this.rect.height+n.offset.y;break;case A.CENTER:this.rect.top=Math.max((i-this.rect.height)/2+n.offset.y,0);break}}}e.animate(this.options.windowAnimateKeyFrames,{duration:300,fill:"forwards",easing:"cubic-bezier(.14,.61,.37,.91)"})}setWindowActive(){this.windowService.setWindowActive(this)}minimize(){if(!!r(this,N)&&this.options.availableResizeType&v.MINIMIZED){const e=r(this,N).getBoundingClientRect(),t=this.taskBarService.getButtonRectByApp(this.application.constructor);t&&(r(this,N).style.transformOrigin=`${t.left-e.left}px ${t.top-e.top}px`),p(this,we,r(this,N).animate([{transform:"scale(0.1)",opacity:0}],{duration:300,fill:"forwards",easing:"cubic-bezier(.14,.61,.37,.91)"})),p(this,Re,this.windowResizeType),this.windowResizeType=v.MINIMIZED,this.windowService.setWindowInactive(this)}}async maximize(){!r(this,N)||this.options.availableResizeType&v.MAXIMIZED&&(p(this,Z,r(this,N).animate([{top:0,left:0,width:"100%",height:"100%"}],{duration:200,fill:"forwards"})),await r(this,Z).finished,this.windowResizeType=v.MAXIMIZED,this.windowService.setWindowActive(this))}async normalize(){var e,t;!r(this,N)||this.options.availableResizeType&v.NORMAL&&(this.windowResizeType===v.MAXIMIZED&&((e=r(this,Z))==null||e.reverse(),await((t=r(this,Z))==null?void 0:t.finished)),this.windowResizeType=v.NORMAL,this.windowService.setWindowActive(this))}async restoreWindow(){var e,t;!r(this,N)||(this.windowResizeType===v.MINIMIZED&&(this.windowResizeType=r(this,Re),(e=r(this,we))==null||e.reverse(),await((t=r(this,we))==null?void 0:t.finished),r(this,N).style.transformOrigin="center center"),this.windowService.setWindowActive(this))}close(){this.application.onCloseWindow(this)}async _close(){r(this,N)&&await r(this,N).animate([...this.options.windowAnimateKeyFrames].reverse(),{duration:200,fill:"forwards",easing:"cubic-bezier(.49,.15,.83,.5)"}).finished}onDragStart(e,t){p(this,G,!0),p(this,D,t),p(this,fe,e.screenX),p(this,me,e.screenY)}onDragMove(e){var n;if(!this.rect||!r(this,G))return;this.windowService.mouseShakeDetector.move(e);let t=e.screenX-r(this,fe),i=e.screenY-r(this,me);if(p(this,fe,e.screenX),p(this,me,e.screenY),r(this,D)===y.NONE){this.windowResizeType===v.MAXIMIZED&&((n=r(this,Z))==null||n.cancel(),this.windowResizeType=v.NORMAL,this.rect.left=e.clientX-this.rect.width/2,this.rect.top=0),this.rect.left+=t,this.rect.top+=i;return}r(this,D)&y.TOP&&(this.rect.top+=i,this.rect.height-=i),r(this,D)&y.RIGHT&&(this.rect.width+=t),r(this,D)&y.BOTTOM&&(this.rect.height+=i),r(this,D)&y.LEFT&&(this.rect.left+=t,this.rect.width-=t)}onDragStop(e){!this.rect||!r(this,G)||(r(this,D)===y.NONE&&(e.clientY<=0&&this.maximize(),this.rect.top<0&&(this.rect.top=0)),r(this,D)&y.TOP&&e.clientY<=0&&(this.rect.height=this.windowService.windowContainer.clientHeight),p(this,G,!1),p(this,D,0))}};let lt=wt;pe=new WeakMap,G=new WeakMap,D=new WeakMap,N=new WeakMap,Re=new WeakMap,we=new WeakMap,Z=new WeakMap,fe=new WeakMap,me=new WeakMap,l(lt,"windowId",0);const ui={type:I.NORMAL,level:ke.MIDDLE,width:800,height:600,position:new Ye(A.CENTER,A.CENTER),resizeable:!0,controlButton:O.CLOSE|O.MINIMIZE|O.MAXIMIZE,availableResizeType:v.NORMAL|v.MINIMIZED|v.MAXIMIZED,defaultResizeType:v.NORMAL,windowAnimateKeyFrames:[{transform:"scale(0.8)",opacity:0},{transform:"scale(1)",opacity:1}]};var L,j,ve,Ce,Tt;class He extends K{constructor(){super();h(this,Ce);h(this,L,new Map);h(this,j,new li(1/0));l(this,"activeWindow$",new k(null));l(this,"windowContainer");l(this,"windows$",new k([]));l(this,"mouseShakeDetector",new ci);h(this,ve,new Map);document.body.addEventListener("pointermove",e=>{var t;(t=this.activeWindow)==null||t.onDragMove(e)}),document.body.addEventListener("pointerup",e=>{var t;(t=this.activeWindow)==null||t.onDragStop(e)}),document.body.addEventListener("pointerleave",e=>{var t;(t=this.activeWindow)==null||t.onDragStop(e)}),this.mouseShakeDetector.mouseShake$.subscribe(()=>{this.onWindowShake()})}get activeWindow(){return this.activeWindow$.value}set activeWindow(e){this.activeWindow$.next(e),e&&r(this,j).set(e,null)}get windows(){return Array.from(r(this,L).entries())}init(e){this.windowContainer=e}createWindow(e,t,i,n){const a=W(W({},ui),Ht(t,Xt));t.titleBar===void 0&&(a.titleBar={title:e.constructor.appName,icon:e.constructor.appIcon});const c=x(this,Ce,Tt).call(this,a.level),u=new lt(a,e);return u.zIndex=c.length,r(this,L).set(u,{component:i,props:n}),this.activeWindow&&(this.activeWindow.active=!1),u.active=!0,this.activeWindow=u,this.windows$.next(this.windows),u}async closeWindow(e){var t;await e._close(),r(this,L).delete(e),r(this,j).remove(e),this.activeWindow=(t=r(this,j).mostUsed)!=null?t:null,this.activeWindow&&(this.activeWindow.active=!0),this.windows$.next(this.windows)}setWindowInactive(e){const t=Array.from(r(this,j).cache.keys());if(this.activeWindow===e){const i=t.find(n=>n.windowResizeType!==v.MINIMIZED&&n!==e);i?this.setWindowActive(i):this.setDesktopActive()}}setTaskBarActive(){this.activeWindow!==null&&(this.activeWindow.active=!1,this.activeWindow=null)}setDesktopActive(){this.activeWindow!==null&&(this.activeWindow.active=!1,this.activeWindow=null)}setWindowActive(e){if(this.activeWindow===e)return;const t=x(this,Ce,Tt).call(this,e.level),i=e.zIndex;t.splice(i,1),this.activeWindow&&(this.activeWindow.active=!1),t.push(e);for(let n=i;n<t.length;n++)t[n].zIndex=n;e.active=!0,this.activeWindow=e}onWindowShake(){if(r(this,L).size<1)return;let e=!1;for(const[t]of r(this,L))if(t.windowResizeType!==v.MINIMIZED&&t!==this.activeWindow){e=!0;break}if(e)for(const[t]of r(this,L))r(this,ve).set(t,t.windowResizeType),t!==this.activeWindow&&(t.windowResizeType=v.MINIMIZED);else{for(const[t,i]of r(this,ve))t.windowResizeType=i;r(this,ve).clear()}}}L=new WeakMap,j=new WeakMap,ve=new WeakMap,Ce=new WeakSet,Tt=function(e){return Array.from(r(this,L).keys()).filter(t=>t.level===e).sort((t,i)=>t.zIndex-i.zIndex)};var di="/win11/assets/start.9b37f404.png";class J{constructor(){l(this,"windows",new Set);l(this,"launchBy");l(this,"runInBackground",!1);l(this,"windowService",He.getInstance());l(this,"appService",ht.getInstance())}createWindow(e,t,i){const n=this.windowService.createWindow(this,e,t,i);return this.windows.add(n),n}async closeWindow(e){await this.windowService.closeWindow(e),this.windows.delete(e),this.windows.size===0&&!this.runInBackground&&await this.exit()}async exit(){this.windows.size>0&&await Promise.all(Array.from(this.windows).map(async e=>{await this.closeWindow(e)})),this.appService.terminate(this.constructor),this.onDestroy()}onCloseWindow(e){this.closeWindow(e)}onDestroy(){}}l(J,"appIcon",di),l(J,"appName","Application"),l(J,"appVersion","0.0.1"),l(J,"appDescription","Application description");function be({vertical:s=!0,horizontal:e=!1,justify:t="start",align:i="start",fill:n=!1,className:a,style:c,children:u}){const m={display:"flex",justifyContent:t,alignItems:i};return s&&(m.flexDirection="column"),e&&(m.flexDirection="row"),n&&(m.flexGrow=1),c&&Object.assign(m,c),o("div",{className:B("layout",a),style:m,children:u})}function pi(m,u){var w=m,{className:s,onClick:e,children:t,type:i="default",size:n="default",disabled:a}=w,c=Le(w,["className","onClick","children","type","size","disabled"]);return o("button",gt(W({className:B("button",`button--${i}`,`button-size--${n}`,s,{"button--disabled":a}),onClick:e,ref:u},c),{children:t}))}var C=T.exports.forwardRef(pi);function wi(t){var i=t,{menus:s}=i,e=Le(i,["menus"]);const n=T.exports.useRef(null),a=ut();function c(){a.dropdown(n,s)}return o(C,W({ref:n,onClick:c},e))}var fi={Button:wi};const mi=[{icon:g.CreateFolder,text:"\u65B0\u5EFA\u6587\u4EF6\u5939"}];function vi(){return b(be,{horizontal:!0,align:"center",className:"explorer-toolbar",children:[b(fi.Button,{type:"text",className:"explorer-toolbar-item",menus:mi,children:[o(R,{glyph:g.New,className:"explorer-toolbar-item-icon"}),o("span",{children:"\u65B0\u5EFA"}),o(H,{name:"down",style:{fontSize:"12px",margin:"0 3px"}})]}),o("div",{className:"explorer-toolbar-divider"}),o(C,{type:"text",className:"explorer-toolbar-item",children:o(R,{glyph:g.Cut,className:"explorer-toolbar-item-icon"})}),o(C,{type:"text",className:"explorer-toolbar-item",children:o(R,{glyph:g.Copy,className:"explorer-toolbar-item-icon"})}),o(C,{type:"text",className:"explorer-toolbar-item",children:o(R,{glyph:g.CopyLocation,className:"explorer-toolbar-item-icon"})}),o(C,{type:"text",className:"explorer-toolbar-item",children:o(R,{glyph:g.Paste,className:"explorer-toolbar-item-icon"})}),o(C,{type:"text",className:"explorer-toolbar-item",children:o(R,{glyph:g.Rename,className:"explorer-toolbar-item-icon"})}),o(C,{type:"text",className:"explorer-toolbar-item",children:o(R,{glyph:g.Share,className:"explorer-toolbar-item-icon"})}),o(C,{type:"text",className:"explorer-toolbar-item",children:o(R,{glyph:g.Delete,className:"explorer-toolbar-item-icon"})}),o("div",{className:"explorer-toolbar-divider"}),b(C,{type:"text",className:"explorer-toolbar-item",children:[o(R,{glyph:g.SortBy,className:"explorer-toolbar-item-icon"}),o("span",{children:"\u6392\u5E8F"}),o(H,{name:"down",style:{fontSize:"12px",margin:"0 3px"}})]}),o(C,{type:"text",className:"explorer-toolbar-item",children:o(R,{glyph:g.Properties,className:"explorer-toolbar-item-icon"})})]})}function gi(){return o(be,{horizontal:!0,children:b(be,{horizontal:!0,className:"folder-navigator",children:[o("div",{className:"folder-navigator-icon",children:o(H,{name:"arrow-left"})}),o("div",{className:"folder-navigator-icon",children:o(H,{name:"arrow-right"})}),o("div",{className:"folder-navigator-icon",children:o(H,{name:"arrow-up"})})]})})}function Dt(){return b(be,{vertical:!0,fill:!0,className:"explorer",children:[o(vi,{}),o(be,{vertical:!0,fill:!0,className:"explorer-content",children:o(gi,{})})]})}var yi="/win11/assets/explorer.6806a934.png";class q extends J{launch(e){this.createWindow({},Dt),setTimeout(()=>{this.createWindow({position:new Ye(A.CENTER,A.CENTER,new d(32,32))},Dt)},1e3)}onCloseWindow(e){this.closeWindow(e)}}l(q,"appIcon",yi),l(q,"appName","Explorer"),l(q,"appVersion","0.0.1"),l(q,"appDescription","\u6587\u4EF6\u8D44\u6E90\u7BA1\u7406\u5668");function xi(s){const ft=s,{className:e,label:t,placeholder:i,value:n,onChange:a,onBlur:c,onFocus:u,disabled:m,type:w,size:E,prefix:F}=ft,S=Le(ft,["className","label","placeholder","value","onChange","onBlur","onFocus","disabled","type","size","prefix"]),[f,V]=T.exports.useState(!1);function Ct(tt){V(!0),u==null||u(tt)}function zt(tt){V(!1),c==null||c(tt)}return b("div",{className:B("text-field",{"text-field--large":E==="large"},e),children:[F&&o("span",{className:"text-field__prefix",children:F}),o("input",W({className:"text-field__input",type:w,placeholder:i,value:n,onChange:a,onFocus:Ct,onBlur:zt,disabled:m},S)),o("span",{className:"text-field__suffix"})]})}var bi="/win11/assets/settings.7ee73577.png",Ei="/win11/assets/explorer.6806a934.png",Ni="/win11/assets/edge.b54a3398.png",Ii="/win11/assets/store-light.0268c85a.png",Ai="data:image/png;base64,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";const Mi=[{name:"Settings",icon:bi},{name:"Explorer",icon:Ei},{name:"Edge",icon:Ni},{name:"Store",icon:Ii},{name:"VSCode",icon:Ai}];function Oi(){return b("div",{className:"start-menu",children:[o(xi,{placeholder:"\u5728\u6B64\u952E\u5165\u4EE5\u641C\u7D22",size:"large",prefix:o(H,{name:"sousuo"})}),b("div",{className:"pinned-apps",children:[b("div",{className:"pinned-apps-header",children:[o("div",{className:"pinned-apps-header-title",children:"\u5DF2\u56FA\u5B9A"}),o("div",{className:"pinned-apps-header-more",children:o(C,{size:"mini",children:"\u5168\u90E8\u5E94\u7528"})})]}),o("div",{className:"pinned-apps-content",children:Mi.map(s=>b("div",{className:"pinned-apps-content-item",children:[o("div",{className:"pinned-apps-content-item-icon",children:o("img",{src:s.icon,alt:s.name})}),o("div",{className:"pinned-apps-content-item-title",children:s.name})]}))})]})]})}var Si="/win11/assets/start.9b37f404.png";class Xe extends J{launch(e){const t=this.createWindow({type:I.WIDGET,level:ke.TOP,width:620,height:700,position:new Ye(A.CENTER,A.BOTTOM,new d(0,-10)),windowAnimateKeyFrames:[{transform:"translateY(100%)"},{transform:"translateY(0)"}]},Oi),i=t.active$.subscribe(n=>{n||(t.close(),i.unsubscribe())})}}l(Xe,"appIcon",Si),l(Xe,"appName","StartMenu"),l(Xe,"appDescription","\u5F00\u59CB\u83DC\u5355");const Ti=[q],Di=[Xe,q];var P,ge,ze,Bt;class ht extends K{constructor(){super();h(this,ze);h(this,P,new Map);h(this,ge,void 0);p(this,ge,new k(Array.from(r(this,P).entries())))}get apps$(){return r(this,ge).asObservable()}onStartUp(){for(const e of Ti)this.launch(e)}terminate(e){const t=r(this,P).get(e);t&&(t.onDestroy(),r(this,P).delete(e),x(this,ze,Bt).call(this))}launch(e,t){let i=r(this,P).get(e);i||(i=new e,r(this,P).set(e,i),x(this,ze,Bt).call(this)),i.launch(),i.launchBy=t}}P=new WeakMap,ge=new WeakMap,ze=new WeakSet,Bt=function(){r(this,ge).next(Array.from(r(this,P).entries()))};function Ee(s){return()=>T.exports.useRef(s).current}const Rt=Ee(new He),Bi=Ee(new ht),Ri=Ee(new St(He.getInstance(),ht.getInstance())),Ci=Ee(new Pe),ut=Ee(new Mt(Pe.getInstance()));function zi({children:s,controller:e}){const t=xe(e.windowResizeType$),i=xe(e.active$),n=T.exports.useRef(null),a=ut();T.exports.useEffect(()=>{const f=n.current;f&&e.init(f)},[]);const{type:c,titleBar:u,resizeable:m,controlButton:w}=e.options,E=B("window-resizer",{"window-resizer-without-title-bar":Boolean(u)}),F=[w&O.MINIMIZE&&o("div",{className:E,onClick:()=>e.minimize(),children:o("span",{className:"iconfont icon-minimize"})},"minimize"),w&O.MAXIMIZE&&b(We,{children:[t===v.MAXIMIZED&&o("div",{className:E,onClick:()=>e.normalize(),children:o("span",{className:"iconfont icon-restore"})},"restore"),t===v.NORMAL&&o("div",{className:E,onClick:()=>e.maximize(),children:o("span",{className:"iconfont icon-maximize"})},"maximize")]}),w&O.CLOSE&&o("div",{className:B(E,"window-resizer-close"),onClick:()=>e.close(),children:o("span",{className:"iconfont icon-close"})},"close")].filter(Boolean),S=[{text:"\u8FD8\u539F",disabled:!(Boolean(w&O.MAXIMIZE)&&t===v.MAXIMIZED),icon:"restore",onSelect:()=>e.normalize()},{text:"\u6700\u5C0F\u5316",disabled:!Boolean(w&O.MINIMIZE),icon:"minimize",onSelect:()=>e.minimize()},{text:"\u6700\u5927\u5316",disabled:!(Boolean(w&O.MAXIMIZE)&&t===v.NORMAL),icon:"maximize",onSelect:()=>e.maximize()},{type:Q.Separator},{text:"\u5173\u95ED",disabled:!Boolean(w&O.CLOSE),icon:"close",onSelect:()=>e.close()}];return b("div",{ref:n,className:B("window",{"window-minimize":t===v.MINIMIZED,"window-maximize":t===v.MAXIMIZED,"window-border":c===I.NORMAL,"window-fullscreen":c===I.FULLSCREEN,"window-active":i,"window-inactive":!i}),onPointerDown:f=>{e.setWindowActive(),f.stopPropagation()},onContextMenu:f=>{f.preventDefault(),f.stopPropagation()},children:[c===I.NORMAL&&o(We,{children:u?b("div",{className:"window-title-bar",children:[b("div",{className:"window-title-bar-dragable",onPointerDown:f=>e.onDragStart(f,0),onDoubleClick:()=>{w&O.MAXIMIZE&&(t&v.MAXIMIZED?e.normalize():e.maximize())},onContextMenu:f=>{f.preventDefault(),f.stopPropagation(),a.show(new d(f.clientX,f.clientY),S)},children:[o("div",{className:"window-title-bar-icon",draggable:"false",children:o("img",{width:"16",src:u.icon,alt:u.title,draggable:"false"})}),o("div",{className:"window-title-bar-name",draggable:"false",children:u.title})]}),F]}):F.reverse()}),m&&c!==I.FULLSCREEN&&b("div",{className:"crop",children:[o("div",{className:"crop-line crop-top-line",onPointerDown:f=>e.onDragStart(f,y.TOP)}),o("div",{className:"crop-line crop-right-line",onPointerDown:f=>e.onDragStart(f,y.RIGHT)}),o("div",{className:"crop-line crop-bottom-line",onPointerDown:f=>e.onDragStart(f,y.BOTTOM)}),o("div",{className:"crop-line crop-left-line",onPointerDown:f=>e.onDragStart(f,y.LEFT)}),o("div",{className:"crop-corner crop-top-left-corner",onPointerDown:f=>e.onDragStart(f,y.TOP|y.LEFT)}),o("div",{className:"crop-corner crop-top-right-corner",onPointerDown:f=>e.onDragStart(f,y.TOP|y.RIGHT)}),o("div",{className:"crop-corner crop-bottom-right-corner",onPointerDown:f=>e.onDragStart(f,y.BOTTOM|y.RIGHT)}),o("div",{className:"crop-corner crop-bottom-left-corner",onPointerDown:f=>e.onDragStart(f,y.BOTTOM|y.LEFT)})]}),s]})}var Fi=ye.memo(zi);function Li({children:s,controller:e}){const t=T.exports.useRef(null);return T.exports.useEffect(()=>{const i=t.current;i&&e.init(i)},[]),o("div",{ref:t,className:"window window-border window-active widget",onPointerDown:i=>{e.setWindowActive(),i.stopPropagation()},onContextMenu:i=>{i.preventDefault(),i.stopPropagation()},children:s})}function ki(){const s=Rt(),e=Ri(),t=xe(e.buttons$,[]);return o("div",{className:"task-bar",onPointerDown:()=>s.setTaskBarActive(),children:t.map(i=>b("button",{ref:i.ref,onClick:()=>e.onClickButton(i.App),onPointerDown:n=>n.stopPropagation(),className:B("task-bar-app-btn",{"task-bar-app-btn-active":i.active,"task-bar-app-btn-running":i.running}),children:[o("img",{width:"22",src:i.App.appIcon,alt:i.App.appName}),o("div",{className:"task-bar-app-btn-indicator"})]},i.App.appName))})}const Pi=[{text:"Menu 1"},{text:"\u4E00\u4E8C\u4E09\u56DB\u4E94"},{text:"Menu 3"},{text:"Menu 4",disabled:!0},{text:"\u8FD9\u4E2A\u83DC\u5355\u5C31\u5F88\u957F\u957F\u957F",children:[{text:"Menu 5.1"},{text:"Menu 5.2"},{text:"\u770B\u770B\u957F\u957F\u7684\u83DC\u5355\u6587\u5B57\u6709\u591A\u957F"},{text:"Menu 5.4",disabled:!0}]},{text:"Menu 6"},{text:"Menu 7"}];function Wi(){const s=Ci(),e=xe(s.overlays$),t=[];for(const i of e)i.config.hasBackdrop&&t.push(o("div",{style:{zIndex:1e3},className:B(i.config.backdropClass),onClick:n=>{n.stopPropagation(),i._backdropClick.next(n.nativeEvent)}})),t.push(i.node);return o(We,{children:t})}function Yi(){var c,u,m;const s=T.exports.useRef(null),e=Bi(),t=Rt(),i=ut(),n=xe(t.windows$);T.exports.useEffect(()=>{t.init(s.current),e.onStartUp()},[]);const a=Zt(n,([w])=>w.options.type);return b(We,{children:[b("div",{className:"windows",children:[b("div",{ref:s,className:"windows-container",onPointerDown:()=>t.setDesktopActive(),onContextMenu:w=>{w.preventDefault(),i.show(new d(w.clientX,w.clientY),Pi)},children:[[...(c=a[I.NORMAL])!=null?c:[],...(u=a[I.BORDER_LESS])!=null?u:[]].map(([w,E])=>o(Fi,{controller:w,children:o(E.component,W({},E.props))},w.windowId)),((m=a[I.WIDGET])!=null?m:[]).map(([w,E])=>o(Li,{controller:w,children:o(E.component,W({},E.props))},w.windowId))]}),o(ki,{})]}),o(Wi,{})]})}Vt.render(o(ye.StrictMode,{children:o(Yi,{})}),document.getElementById("root"));
